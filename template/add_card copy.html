<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Drag Cards</title>
<style>
  .card {
    margin-bottom: 10px;
    border: 1px solid #ccc;
    padding: 10px;
    cursor: grab;
  }

  .popup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border: 2px dashed #ccc;
    padding: 20px;
    background-color: #fff;
  }

  .archived {
    display: none; 
  }
</style>
</head>
<body>

<div class="container">
  <div id="popup" class="popup" ondrop="drop(event)" ondragover="allowDrop(event)">
    <h2>Popup Folder</h2>
  </div>
 
  <div id="cards" class="row">
    
  </div>
</div>

<script>
  let draggedCard = null;

  function drag(event) {
    draggedCard = event.target;
    const popup = document.getElementById("popup");
    popup.style.display = "block"; 
  }

  function allowDrop(event) {
    event.preventDefault();
  }

  function drop(event) {
    event.preventDefault();
    const popup = document.getElementById("popup");
    const cardsContainer = document.getElementById("cards");
  
    const archivedCard = draggedCard.cloneNode(true);
    archivedCard.classList.add("archived");
  
    archiveCard(draggedCard.id);
  
    draggedCard.parentNode.removeChild(draggedCard);
  
    cardsContainer.appendChild(archivedCard);
  
    popup.style.display = "none";
  }

  function archiveCard(cardId) {
    let archivedCards = JSON.parse(localStorage.getItem("archivedCards")) || [];
    archivedCards.push(cardId);
    localStorage.setItem("archivedCards", JSON.stringify(archivedCards));
  }

  function loadCards() {
    const cardsContainer = document.getElementById("cards");
    const allCards = [
      { id: "card1", text: "Card 1" },
      { id: "card2", text: "Card 2" },
      { id: "card3", text: "Card 3" },
      { id: "card4", text: "Card 4" },
      { id: "card5", text: "Card 5" }
    ];

    const archivedCardIds = JSON.parse(localStorage.getItem("archivedCards")) || [];
  
    const nonArchivedCards = allCards.filter(card => !archivedCardIds.includes(card.id));
  
    nonArchivedCards.forEach(cardData => {
      const card = document.createElement("div");
      card.textContent = cardData.text;
      card.classList.add("card");
      card.setAttribute("id", cardData.id);
      card.addEventListener("mousedown", mouseDown);
      card.addEventListener("touchstart", touchStart);
      cardsContainer.appendChild(card);
    });
  }

  function mouseDown(event) {
    event.preventDefault();
    drag(event);
    window.addEventListener("mousemove", mouseMove);
    window.addEventListener("mouseup", mouseUp);
  }

  function mouseMove(event) {
    event.preventDefault();
    if (draggedCard) {
      draggedCard.style.position = "fixed";
      draggedCard.style.left = (event.clientX - draggedCard.offsetWidth / 2) + "px";
      draggedCard.style.top = (event.clientY - draggedCard.offsetHeight / 2) + "px";
    }
  }

  function mouseUp(event) {
    event.preventDefault();
    if (draggedCard) {
      drop(event);
      draggedCard.style.position = "";
      draggedCard.style.left = "";
      draggedCard.style.top = "";
      window.removeEventListener("mousemove", mouseMove);
      window.removeEventListener("mouseup", mouseUp);
    }
  }

  function touchStart(event) {
    event.preventDefault();
    draggedCard = event.target;
    const touch = event.touches[0];
    const popup = document.getElementById("popup");
    popup.style.display = "block"; 
    draggedCard.style.position = "fixed";
    draggedCard.style.left = (touch.clientX - draggedCard.offsetWidth / 2) + "px";
    draggedCard.style.top = (touch.clientY - draggedCard.offsetHeight / 2) + "px";
    window.addEventListener("touchmove", touchMove);
    window.addEventListener("touchend", touchEnd);
  }

  function touchMove(event) {
    event.preventDefault();
    if (draggedCard) {
      const touch = event.touches[0];
      draggedCard.style.left = (touch.clientX - draggedCard.offsetWidth / 2) + "px";
      draggedCard.style.top = (touch.clientY - draggedCard.offsetHeight / 2) + "px";
    }
  }

  function touchEnd(event) {
    event.preventDefault();
    if (draggedCard) {
      const touch = event.changedTouches[0];
      drop(event);
      draggedCard.style.position = "";
      draggedCard.style.left = "";
      draggedCard.style.top = "";
      window.removeEventListener("touchmove", touchMove);
      window.removeEventListener("touchend", touchEnd);
    }
  }

  document.addEventListener("DOMContentLoaded", loadCards);
</script>

</body>
</html>
