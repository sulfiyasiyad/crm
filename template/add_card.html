<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard</title>
<style>
  .card {
    margin-bottom: 10px;
    border: 1px solid #ccc;
    padding: 10px;
    cursor: grab;
  }

  .popup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border: 2px dashed #ccc;
    padding: 20px;
    background-color: #fff;
    z-index: 9999; /* Ensure popup is on top of other elements */
  }

  .archived {
    display: none; 
  }

  @media (max-width: 768px) {
    /* Adjust styles for mobile devices */
    .popup {
      width: 80%; /* Set width to fit smaller screens */
      max-width: 300px; /* Limit maximum width */
      padding: 10px; /* Reduce padding for smaller screens */
    }
  }
</style>
</head>
<body>
<div class="container">
 
  <div id="popup" class="popup" ondrop="drop(event)" ondragover="allowDrop(event)">
    <h2>Popup Folder</h2>
  </div>
 
  <div id="cards" class="row">
    
  </div>
</div>

<script>
  let draggedCard = null;
  let touchStartX, touchStartY;

  function dragStart(event) {
    draggedCard = event.target;
    const popup = document.getElementById("popup");
    popup.style.display = "block";

    if (event.type === "touchstart") {
      touchStartX = event.touches[0].clientX;
      touchStartY = event.touches[0].clientY;
    }

    event.preventDefault();
  }

  function dragMove(event) {
    if (draggedCard) {
      if (event.type === "touchmove") {
        const touchMoveX = event.touches[0].clientX;
        const touchMoveY = event.touches[0].clientY;
        const deltaX = touchMoveX - touchStartX;
        const deltaY = touchMoveY - touchStartY;
        draggedCard.style.transform = `translate(${deltaX}px, ${deltaY}px)`;
      }
    }
  }

  function dragEnd(event) {
    const popup = document.getElementById("popup");
    const cardsContainer = document.getElementById("cards");

    if (event.type === "touchend" || event.type === "touchcancel") {
      draggedCard.style.transform = ""; // Reset transformation
      draggedCard = null;
      event.preventDefault(); // Prevent default touchend behavior
    }

    if (draggedCard) {
      const archivedCard = draggedCard.cloneNode(true);
      archivedCard.classList.add("archived");
      archiveCard(draggedCard.id);
      draggedCard.parentNode.removeChild(draggedCard);
      cardsContainer.appendChild(archivedCard);
      popup.style.display = "none";
      draggedCard = null;
    }
  }

  function allowDrop(event) {
    event.preventDefault();
  }

  function drop(event) {
    event.preventDefault();
  }

  function archiveCard(cardId) {
    let archivedCards = JSON.parse(localStorage.getItem("archivedCards")) || [];
    archivedCards.push(cardId);
    localStorage.setItem("archivedCards", JSON.stringify(archivedCards));
  }

  function loadCards() {
    const cardsContainer = document.getElementById("cards");
    const allCards = [
      { id: "card1", text: "Card 1" },
      { id: "card2", text: "Card 2" },
      { id: "card3", text: "Card 3" },
      { id: "card4", text: "Card 4" },
      { id: "card5", text: "Card 5" },
    ];

    const archivedCardIds = JSON.parse(localStorage.getItem("archivedCards")) || [];

    const nonArchivedCards = allCards.filter(card => !archivedCardIds.includes(card.id));

    nonArchivedCards.forEach(cardData => {
      const card = document.createElement("div");
      card.textContent = cardData.text;
      card.classList.add("card");
      card.setAttribute("id", cardData.id);
      card.setAttribute("draggable", true);
      cardsContainer.appendChild(card);

      // For mouse events
      card.addEventListener("dragstart", dragStart);
      card.addEventListener("dragend", dragEnd);

      // For touch events
      card.addEventListener("touchstart", dragStart);
      card.addEventListener("touchmove", dragMove);
      card.addEventListener("touchend", dragEnd);
      card.addEventListener("touchcancel", dragEnd);
    });
  }

  document.addEventListener("DOMContentLoaded", loadCards);

  document.getElementById("popup").addEventListener("drop", drop);
  document.getElementById("popup").addEventListener("dragover", allowDrop);
</script>
</body>
</html>
